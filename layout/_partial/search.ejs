<div class="section" id="Search">
	<div class="section_content">
		<h3>
		<%= theme.search_title == null ? __('Search Title') : theme.search_title  %>
		<br>
		<%= theme.search_subtitle == null ? __('Search Subtitle') : theme.search_subtitle %>
		</h3>
		<div id="search_content" class="search_content-modal unexpanded">
			<div id="search-view">
				<div class="search-info box">
					<input type="text" id="search-input" placeholder="<%= __('Enter Keyword') %>" onkeyup="searchInputOnKeyUp()">
					<div class="magnifying-glass" id="search-button" onclick="searchInSite(event)">
						<svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 500 500">
						<path fill="none" stroke="#fff" stroke-width="36" stroke-linecap="round" d="m280,278a153,153 0 1,0-2,2l170,170m-91-117 110,110-26,26-110-110"></path>
					</svg>
				</div>
			</div>
			<div class="modal" id="search_result" style="display:none">
				<h2 id="search_result_title">Found 0 match(es):</h2>
				<ul id="search_result_list">
				</ul>
				<span>
					<button onclick="dismissSearchResultModal()">Ã—</button>
				</span>
			</div>
		</div>
	</div>
</div>
<%
var temp = "";
site.posts.each(function(post, index) {
temp += "::qa::lurn::qa::"+post.title+"::qa::lurn::qa::"+post.permalink+"::qa::lurn::qa::"+post.content+(index+1 == site.posts.length ? "::qa::lurn::qa::" : "");
});
%>
<%- js('js/lunr.min') %>
<script>
var content = lunr(function () {
this.field('title');
this.field('content');
this.ref('id');
})
	var postsAllText = (function () {/*<%= temp %>*/}).toString();
	var arr = postsAllText.split("::qa::lurn::qa::");
	for(var i = 1; i+2 <= arr.length - 3; i+=3) {
	content.add({
	id: Math.floor(i/3),
	title: arr[i],
	content: arr[i+2]
	});
	}
	function searchInSite() {
		var keyword = document.getElementById("search-input").value;
		var result = content.search(keyword);
		if (result.length == 0) {
			document.getElementById("search_result_title").innerHTML = "Found 0 match.";
		} else {
			document.getElementById("search_result_title").innerHTML = "Found "+result.length+" match(es):";
		}
		document.getElementById("search_result_list").innerHTML = "";
		for(var i = 0; i < result.length; i++) {
			document.getElementById("search_result_list").innerHTML += '<li><a href="'+arr[result[i].ref*3+2]+'">'+arr[result[i].ref*3+1]+'</a></li>';
		}
		document.getElementById("search_result").style.display = "block";
	}
	function dismissSearchResultModal() {
		document.getElementById("search_result").style.display = "none";
	}
	function searchInputOnKeyUp() {
		event.preventDefault();
	if (event.keyCode == 13) {
	searchInSite();
	}
	}
</script>
</div>